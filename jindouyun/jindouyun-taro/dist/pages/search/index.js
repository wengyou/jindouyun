(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[33],{115:function(e,t,a){},142:function(e,t,a){"use strict";a.r(t);var n=a(4),c=a(7),r=a(0),i=a.n(r),s=a(9),o=a(1),l=a(6),u=a(56),m=a(11),f=(a(115),a(8)),_=a.n(f),w=a(12),h=a(13),d=a(5),p=function(e){var t=e.page,a=e.callback,n=e.keyword;return function(){var e=Object(w["a"])(_.a.mark((function e(c){var r;return _.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["a"])("get","wx/search/list?page=".concat(t,"&keyword=").concat(n));case 2:r=e.sent,Object(m["b"])(!1),a(!1),0===r.errno&&(c({type:d["F"],payload:r.data}),c(g()));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(){return function(){var e=Object(w["a"])(_.a.mark((function e(t){var a;return _.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["a"])("get","wx/search/index");case 2:a=e.sent,0===a.errno&&t({type:d["t"],payload:a.data.historyKeywordList});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=function(){return function(){var e=Object(w["a"])(_.a.mark((function e(t){var a;return _.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["a"])("post","wx/search/clearhistory");case 2:a=e.sent,0===a.errno&&t({type:d["i"]});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b=function(){return function(e){e({type:d["e"]})}},y=a(29),E=a(2),k=a.p+"assets/images/search_0.png",N=a(30),j=a(18),O=function(e){var t=e.dispatchDeleteHistory,a=e.dispatchClearSearch,n=e.dispatchFetchHistory,s=e.dispatchSearch,m=e.historyList,f=e.searchList,_=e.nowPage,w=e.maxPage,h=Object(r["useState"])(""),d=Object(c["a"])(h,2),p=d[0],g=d[1],x=Object(r["useState"])(!1),b=Object(c["a"])(x,2),O=b[0],C=b[1],V=Object(r["useState"])(!1),v=Object(c["a"])(V,2),S=v[0],P=v[1],L=Object(r["useState"])(!1),T=Object(c["a"])(L,2),B=T[0],H=T[1],I=Object(r["useState"])({}),A=Object(c["a"])(I,2),F=A[0],D=A[1],J=function(e,t){D({type:e,info:t,page:"other"}),H(!0)},K=function(e){H(e)};Object(r["useEffect"])((function(){n()}),[]),Object(E["useReachBottom"])((function(){_<w?(C(!0),P(!1),s({page:_+1,keyword:p,callback:function(e){return C(e)}})):(C(!0),P(!0))}));var M=function(){t()},R=function(){0!==p.trim().length&&s({page:1,keyword:p,callback:function(e){return C(e)}})},U=function(e){a(),g(e),s({page:1,keyword:e,callback:function(e){return C(e)}})};return i.a.createElement(o["View"],null,i.a.createElement(o["View"],{className:"search_wrap bgc_yellow"},i.a.createElement(l["AtSearchBar"],{focus:!0,value:p,onChange:U,onConfirm:R,onActionClick:R})),0===p.length?i.a.createElement(o["View"],null,i.a.createElement(o["View"],{className:"flex between padding_xs"},i.a.createElement(o["View"],{className:"search_tit fontS_36 fontC_70"},"\u5386\u53f2\u641c\u7d22"),i.a.createElement(o["Image"],{onClick:M,className:"search_delete",src:u["a"]})),i.a.createElement(o["View"],{className:"flex flex_wrap padding_row_xs"},m.map((function(e){return i.a.createElement(o["View"],{className:"search_history fontS_20 border_10 fontC_white padding_row_xxs margin_xxs"},e.keyword)})))):i.a.createElement(o["View"],{className:"padding_row_s padding_column_xxs flex direction_column"},0!==f.length?f.map((function(e){return i.a.createElement(o["View"],{key:e.id,className:"flex center_column padding_column_xxs padding_row_xs search_item_wrap bgc_white border_10"},i.a.createElement(o["Image"],{className:"search_item_img flex_grow_shrink bgc_f4",onClick:function(){return Object(j["b"])(e.id)},src:e.picUrl}),i.a.createElement(o["View"],{className:"flex_grow flex direction_column min-width"},i.a.createElement(o["View"],{className:"flex_grow"},i.a.createElement(o["View"],null,i.a.createElement(o["View"],{className:"padding_row_xs fontC_26px flex"},i.a.createElement(o["Text"],{className:"ellipsis"},e.name)),i.a.createElement(o["View"],{className:"padding_row_xs fontS_20 fontC_91 flex"},i.a.createElement(o["Text"],{className:"ellipsis"},e.brief))),i.a.createElement(o["View"],{className:"padding_xs flex between center_column"},i.a.createElement(o["Text"],{className:"fontC_orange fontS_36"},"\xa5 ",e.nowPrice))),i.a.createElement(o["View"],{className:"flex direction_row_reverse"},i.a.createElement(o["View"],{className:"search_item_btn bgc_orange fontC_white fontS_24 border_10 flex center",onClick:function(){return J("purchase",e)}},"\u8d2d\u4e70"),i.a.createElement(o["View"],{className:"search_item_btn bgc_yellow fontC_white fontS_24 border_10 flex center margin_row_xs",onClick:function(){return J("add",e)}},"\u6dfb\u52a0"))))})):i.a.createElement(o["View"],{className:"search_null_img_wrap flex direction_column center"},i.a.createElement(o["Image"],{className:"search_null_img",src:k}),i.a.createElement(o["Text"],{className:"fontS_24 fontC_gray_c6"},"\u6362\u4e2a\u8bcd\u8bed\u8bd5\u8bd5\u5427~")),i.a.createElement(N["a"],{openAdd:B,callback:function(e){return K(e)},addInfo:F}),i.a.createElement(y["a"],{showLoad:O,showNoMore:S})))},C=Object(s["b"])((function(e){return{historyList:e.search.historyList,searchList:e.search.searchList,nowPage:e.search.nowPage,maxPage:e.search.maxPage}}),(function(e){return{dispatchDeleteHistory:function(){e(x())},dispatchFetchHistory:function(){e(g())},dispatchSearch:function(t){e(p(t))},dispatchClearSearch:function(){e(b())}}}))(O),V={navigationBarTitleText:"\u641c\u7d22",backgroundColor:"#fdb200",navigationBarTextStyle:"white",navigationBarBackgroundColor:"#fdb200"};Page(Object(n["createPageConfig"])(C,"pages/search/index",{},V||{}))}},[[142,0,1,2,3]]]);